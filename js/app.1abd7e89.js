(function(){"use strict";var e={7174:function(e,t,o){var n=o(9242),r=o(3396),a=o.p+"img/logo.790ac792.png";const s=(0,r._)("img",{src:a,alt:""},null,-1),i=(0,r.Uk)("Feed"),u=(0,r.Uk)("Create Post"),l=(0,r.Uk)("Login");function c(e,t){const o=(0,r.up)("router-link"),n=(0,r.up)("router-view");return(0,r.wg)(),(0,r.iD)(r.HY,null,[(0,r._)("nav",null,[s,(0,r._)("div",null,[(0,r.Wm)(o,{to:"/"},{default:(0,r.w5)((()=>[i])),_:1}),(0,r.Wm)(o,{to:"/create"},{default:(0,r.w5)((()=>[u])),_:1}),(0,r.Wm)(o,{to:"/login"},{default:(0,r.w5)((()=>[l])),_:1})])]),(0,r.Wm)(n,{class:"view"})],64)}var d=o(89);const p={},m=(0,d.Z)(p,[["render",c]]);var h=m,g=o(678);const f=(0,r._)("h1",null,"Mini Feed",-1);function v(e,t,o,n,a,s){const i=(0,r.up)("PostCard"),u=(0,r.up)("PaginationRow");return(0,r.wg)(),(0,r.iD)("div",null,[f,((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(a.posts,(e=>((0,r.wg)(),(0,r.j4)(i,{key:e.id,author:e.author,created:s.formatDate(e.created),id:e.id,text:e.text},null,8,["author","created","id","text"])))),128)),(0,r.Wm)(u,{modelValue:a.page,"onUpdate:modelValue":t[0]||(t[0]=e=>a.page=e),pages:a.pages},null,8,["modelValue","pages"])])}var _=o(7139);const w={class:"post-card"},b={class:"author"},y=(0,r.Uk)(" wrote "),k={class:"text"},x={class:"time"};function P(e,t,o,n,a,s){return(0,r.wg)(),(0,r.iD)("div",w,[(0,r._)("p",b,[(0,r._)("span",null,[(0,r._)("b",null,(0,_.zw)(o.author.username),1)]),y]),(0,r._)("p",k,(0,_.zw)(o.text),1),(0,r._)("p",x,(0,_.zw)(o.created),1)])}var O={props:{author:{type:Object,default:null,required:!0},created:{type:String,required:!0},text:{type:String,required:!0}}};const S=(0,d.Z)(O,[["render",P],["__scopeId","data-v-dcaed834"]]);var U=S;const T={class:"pagination"},$=["onClick"];function D(e,t,o,n,a,s){return(0,r.wg)(),(0,r.iD)("div",T,[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(o.pages,(e=>((0,r.wg)(),(0,r.iD)("span",{class:(0,_.C_)(["pagination-item",{"pagination-item-active":e==o.modelValue}]),onClick:t=>s.changePage(e),key:`page-${e}`},(0,_.zw)(e),11,$)))),128))])}var z={props:{modelValue:{type:Number,required:!0},pages:{type:Number,required:!0}},methods:{changePage(e){this.$emit("update:modelValue",e)}}};const C=(0,d.Z)(z,[["render",D],["__scopeId","data-v-7e18d7de"]]);var I=C,M=o(8741),j={components:{PostCard:U,PaginationRow:I},data(){return{posts:[],page:1,pages:1}},mounted(){this.fetchPosts()},methods:{fetchPosts(){this.$axios.get("/posts/",{params:{page:this.page,reversed:!0}}).then((e=>{this.posts=e.data.posts,this.page=e.data.page,this.pages=e.data.pages})).catch((e=>console.error(e.message)))},formatDate(e){return M.ou.fromISO(e).toFormat("dd/MM/yyyy HH:mm")}},watch:{page(){this.fetchPosts()}}};const V=(0,d.Z)(j,[["render",v]]);var F=V;const H=(0,r._)("h1",null,"Create Post",-1),L=(0,r._)("button",{type:"submit"},"Create",-1);function Z(e,t,o,a,s,i){return(0,r.wg)(),(0,r.iD)("div",null,[H,(0,r._)("form",{onSubmit:t[1]||(t[1]=(0,n.iM)(((...e)=>i.createPost&&i.createPost(...e)),["prevent"]))},[(0,r.wy)((0,r._)("textarea",{rows:"15",placeholder:"Text","onUpdate:modelValue":t[0]||(t[0]=e=>s.text=e)},null,512),[[n.nr,s.text]]),L],32)])}var q={data(){return{text:""}},methods:{createPost(){this.$axios.post("/posts/",{text:this.text}).then((()=>{this.text="",this.$toast.success("Post created!",{position:"bottom"})})).catch((e=>{console.error(e.message),this.$toast.info("First you need to login!",{position:"bottom"})}))}}};const W=(0,d.Z)(q,[["render",Z]]);var R=W;const E={key:0},Y=(0,r._)("h1",null,"Login",-1),A=(0,r._)("button",{type:"submit"},"Enter",-1),B={key:1},K={class:"user-info"},N=(0,r._)("b",null,"Email:",-1),G=(0,r._)("b",null,"Created at:",-1),J=(0,r._)("b",null,"Birthdate:",-1),Q=(0,r._)("b",null,"Role:",-1);function X(e,t,o,a,s,i){return null==s.user?((0,r.wg)(),(0,r.iD)("div",E,[Y,(0,r._)("form",{onSubmit:t[2]||(t[2]=(0,n.iM)(((...e)=>i.login&&i.login(...e)),["prevent"]))},[(0,r.wy)((0,r._)("input",{type:"text",placeholder:"UsuÃ¡rio","onUpdate:modelValue":t[0]||(t[0]=e=>s.username=e)},null,512),[[n.nr,s.username]]),(0,r.wy)((0,r._)("input",{type:"password",placeholder:"Senha","onUpdate:modelValue":t[1]||(t[1]=e=>s.password=e)},null,512),[[n.nr,s.password]]),A],32)])):((0,r.wg)(),(0,r.iD)("div",B,[(0,r._)("h1",null,(0,_.zw)(s.user.username)+" (ID "+(0,_.zw)(s.user.id)+")",1),(0,r._)("div",K,[(0,r._)("p",null,[N,(0,r.Uk)(" "+(0,_.zw)(s.user.email),1)]),(0,r._)("p",null,[G,(0,r.Uk)(" "+(0,_.zw)(i.created_at_formatted),1)]),(0,r._)("p",null,[J,(0,r.Uk)(" "+(0,_.zw)(i.birthdate_formatted),1)]),(0,r._)("p",null,[Q,(0,r.Uk)(" "+(0,_.zw)(s.user.role.name),1)]),(0,r._)("button",{class:"logout-button",onClick:t[3]||(t[3]=e=>i.logout())},"Logout")])]))}var ee={data(){return{username:"",password:"",user:null}},mounted(){localStorage.getItem("authToken")&&this.fetchUser()},methods:{login(){this.$axios.post("/auth/login",{username:this.username,password:this.password}).then((e=>{this.$axios.storeToken(e.data.access_token),this.fetchUser(),this.$toast.success("Login successful!",{position:"bottom"})})).catch((e=>{console.error(e.message),this.$toast.error("Invalid credentials!",{position:"bottom"})}))},fetchUser(){this.$axios.get("/users/me").then((e=>{this.user=e.data})).catch((e=>{console.error(e.message)}))},logout(){this.user=null,localStorage.removeItem("authToken"),this.$axios.updateToken(),this.$toast.info("Logout!",{position:"bottom"})}},computed:{created_at_formatted(){return M.ou.fromISO(this.user.created_at).toFormat("dd/MM/yyyy HH:mm")},birthdate_formatted(){return M.ou.fromISO(this.user.birthdate).toFormat("dd/MM/yyyy")}}};const te=(0,d.Z)(ee,[["render",X]]);var oe=te;const ne=[{path:"/",name:"home",component:F},{path:"/create",name:"create",component:R},{path:"/login",name:"login",component:oe}],re=(0,g.p7)({history:(0,g.PO)("/minifeed/"),routes:ne});var ae=re,se=o(6215),ie=o.n(se),ue=o(6265),le=o.n(ue),ce={install(e){const t=le().create({baseURL:"https://guide-flask.herokuapp.com"});t.updateToken=()=>{null!=localStorage.getItem("authToken")?t.defaults.headers.common["Authorization"]=`Bearer ${localStorage.getItem("authToken")}`:t.defaults.headers.common["Authorization"]=null},t.storeToken=e=>{localStorage.setItem("authToken",e),t.updateToken()},t.updateToken(),e.config.globalProperties.$axios=t}};(0,n.ri)(h).use(ae).use(ce).use(ie()).mount("#app")}},t={};function o(n){var r=t[n];if(void 0!==r)return r.exports;var a=t[n]={exports:{}};return e[n].call(a.exports,a,a.exports,o),a.exports}o.m=e,function(){var e=[];o.O=function(t,n,r,a){if(!n){var s=1/0;for(c=0;c<e.length;c++){n=e[c][0],r=e[c][1],a=e[c][2];for(var i=!0,u=0;u<n.length;u++)(!1&a||s>=a)&&Object.keys(o.O).every((function(e){return o.O[e](n[u])}))?n.splice(u--,1):(i=!1,a<s&&(s=a));if(i){e.splice(c--,1);var l=r();void 0!==l&&(t=l)}}return t}a=a||0;for(var c=e.length;c>0&&e[c-1][2]>a;c--)e[c]=e[c-1];e[c]=[n,r,a]}}(),function(){o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,{a:t}),t}}(),function(){o.d=function(e,t){for(var n in t)o.o(t,n)&&!o.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}}(),function(){o.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){o.p="/minifeed/"}(),function(){var e={143:0};o.O.j=function(t){return 0===e[t]};var t=function(t,n){var r,a,s=n[0],i=n[1],u=n[2],l=0;if(s.some((function(t){return 0!==e[t]}))){for(r in i)o.o(i,r)&&(o.m[r]=i[r]);if(u)var c=u(o)}for(t&&t(n);l<s.length;l++)a=s[l],o.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return o.O(c)},n=self["webpackChunkminifeed"]=self["webpackChunkminifeed"]||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))}();var n=o.O(void 0,[998],(function(){return o(7174)}));n=o.O(n)})();
//# sourceMappingURL=app.1abd7e89.js.map